<div *ngIf="curRoute;then existingRoute else nonExistingRoute"></div>


<!-- cost: number;
    id: JOptSolutionRouteHeaderId;
    idleTime: JOptSolutionRouteHeaderIdleTime;
    prodTime: JOptSolutionRouteHeaderProdTime;
    tranTime: JOptSolutionRouteHeaderTranTime;
    termiTime: JOptSolutionRouteHeaderTermiTime;
    distance: JOptSolutionRouteHeaderDistance;
    termiDistance: JOptSolutionRouteHeaderTermiDistance;
    /**
     * Is an alternate destination in use?
     */
    isAlternateDestination: boolean;
    /**
     * Is the route closed?
     */
    isClosed: boolean;
    /**
     * The route violations, like overtime
     */
    routeViolations: Array<JOptViolation>;
    closed?: boolean;
    alternateDestination?: boolean;
-->



<ng-template #existingRoute>
    <div class="frameborder">
        <mat-expansion-panel [expanded]="true" class="mat-elevation-z0" (opened)="panelOpenState = true"
            (closed)="panelOpenState = false" matTooltip="Click me to enlarge.">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <h4>
                        {{panelOpenState ? 'Close Route Overview' : 'Show Route Overview'}}
                    </h4>

                </mat-panel-title>

            </mat-expansion-panel-header>
            <div style="background-color: whitesmoke;">
                <mat-list dense role="list">
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">RouteId:</div>
                        <div class="mat-list-route-item-value">{{curRoute.id}}</div>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Resource:</div>

                        <div class="mat-list-route-item-value">{{curRoute.visitorId}}</div>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Start:</div>
                        <div class="mat-list-route-item-value">{{curRoute.hoursStart | dateFormatPipe}}</div>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Time:</div>
                        <div class="mat-list-route-item-value">
                            {{curRoute.header.time | durationFormatPipe: 'PT':'auto' }}
                        </div>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Idle:</div>
                        <div class="mat-list-route-item-value">
                            {{curRoute.header.idleTime | durationFormatPipe: 'PT':'auto' }}
                        </div>
                    </mat-list-item>

                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Productive:</div>
                        <div class="mat-list-route-item-value">
                            {{curRoute.header.prodTime | durationFormatPipe: 'PT':'auto' }}
                        </div>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Transit:</div>
                        <div class="mat-list-route-item-value">
                            {{curRoute.header.tranTime | durationFormatPipe: 'PT':'auto' }}
                        </div>
                    </mat-list-item>
                    <mat-list-item role="listitem">
                        <div class="mat-list-route-item-cap">Distance:</div>
                        <div class="mat-list-route-item-value">
                            {{curRoute.header.distance | distanceFormatPipe: 'm':'km' }}
                        </div>
                    </mat-list-item>

                </mat-list>
                <p></p>
            </div>
        </mat-expansion-panel>
    </div>
    <p></p>
    <mat-divider></mat-divider>

    <!-- -->

    <div class="frameborder">
        <h4 style="margin-left:10px;">Path</h4>
        <mat-vertical-stepper [linear]="false" [selectedIndex]="0" #stepper>
            <div *ngFor="let element of curRoute.elementDetails; let i = index" [attr.data-index]="i">

                <mat-step completed="false" style="margin:5px;background-color: whitesmoke;"
                    matTooltip="Click me to enlarge.">

                    <ng-template matStepLabel>
                        {{element.id}}

                    </ng-template>

                    <div style="background-color: whitesmoke;">
                        <app-node-detail [detail]="element"></app-node-detail>
                    </div>

                    <!--<mat-action-row style="background-color: white;">
                    <div *ngIf="step > 0">
                        <button mat-button color="warn" matStepperPrevious>Previous</button>
                    </div>
                    <div *ngIf="curRoute.elementDetails.length-1 > step">
                        <button mat-button  color="primary" matStepperNext>Next</button>
                    </div>
                </mat-action-row>-->
                </mat-step>

            </div>
        </mat-vertical-stepper>
    </div>


    <!--<div style=" overflow: hidden; display: flex;">
        <div style=" width: 1%; min-width: 5px;
    float:left;">
            <div class="vl">
                <span class="dot"></span>
            </div>
        </div>
        <div style="float:right; width:97%;">
            <mat-accordion>
                <div *ngFor="let element of curRoute.elementDetails; let i = index" [attr.data-index]="i">

                    <mat-expansion-panel style="margin:5px;background-color: whitesmoke;" [expanded]="step === i" (opened)="setStep(i)"
                        matTooltip="Click me to enlarge.">
                        <mat-expansion-panel-header  style="background-color: white;">
                            <mat-panel-title>
                                <div>
                                    <img style="vertical-align:middle; height:22px;" src="./assets/maps/marker-icon.png"
                                        alt="node marker">
                                    #{{i+1}}

                                </div>


                            </mat-panel-title>
                            <mat-panel-description style="background-color: white;">
                                {{element.id}}
                            </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div ><app-node-detail [detail]="element"></app-node-detail></div>
                        

                        <p></p>
                        <mat-action-row style="background-color: white;">
                            <div *ngIf="step > 0">
                                <button mat-button color="warn" (click)="prevStep()">Previous Node</button>
                            </div>
                            <div *ngIf="curRoute.elementDetails.length-1 > step">
                                <button mat-button color="primary" (click)="nextStep()">Next Node</button>
                            </div>
                        </mat-action-row>
                    </mat-expansion-panel>

                </div>
            </mat-accordion>
        </div>
    </div>-->
    <p></p>
</ng-template>


<ng-template #nonExistingRoute>
    <p></p>
    Please start an optimization first or make sure the node did not get unassigned..
    <p></p>
</ng-template>

<div mat-dialog-actions>
    <button mat-raised-button matTooltip="Close this dialog." (click)="onCloseClick()" color="primary" cdkFocusInitial>Close</button>
</div>

